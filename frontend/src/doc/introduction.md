# **&nbsp;&nbsp;&nbsp;&nbsp;项目背景**

&nbsp;&nbsp;&nbsp;&nbsp;2018年12月15日，江苏广电栏目《南京零距离》报导北京同仁堂蜂蜜存在过期产品回收、重新分装售卖等问题。"炮制虽繁必不敢省人工 ,品味虽贵必不敢减物力"，同仁堂的百年古训因食品安全而备受嘲讽。而这些问题大都源于食品加工流程不透明，消费者无法知晓食品加工的每一个步骤。同时，由于不透明的食品加工流程，中国每年面临25%到30%的农业食品损失率。 2019 年，国务院颁发《关于深化改革加强食品安全工作的意见》再次强调要进一步提高食品安全管理，建立食品安全追溯体系。可追溯系统作为食品质量安全风险控制管理的一种手段，受到越来越多国家的关注。许多欧美国家禁止不具有可追溯条件的食品进入市场。

# **&nbsp;&nbsp;&nbsp;&nbsp;功能描述**

&nbsp;&nbsp;&nbsp;&nbsp;尽管政府和企业已经使用多种手段进行食品追溯，从源头上防止食品安全问题的发生。但是传统溯源体系依旧有不足之处，其不足之处如下：  
&nbsp;&nbsp;&nbsp;&nbsp; **1.生产环节断裂。**食品从生产、运输到销售这个过程的各个环节的信息存在断裂，环节中的各个主体仅关系相邻实体的信息和有效性。因此在传统追溯体系中，供应链的各个环节未实现全面信息共享，容易造成有效数据缺失或造假。  
 &nbsp;&nbsp;&nbsp;&nbsp;**2.信息不对称。**食品生产者和消费者之间信息不对称。食品生产者并未提供有效渠道供消费者对食品进行溯源并判断食品信息的真实性。此外，消费者对产品的农药添加量、存储运输温度、防腐剂及添加剂的添加量等生产细节一无所知。在这种情况下，普通消费者凭难以判断一个产品的价值。大部分消费者更倾向于价格便宜的产品，将出现大量生产过程造假导致优质产品在市场遇冷的情况。  
 &nbsp;&nbsp;&nbsp;&nbsp;**3.数据泄露问题。**在传统追溯体系中，供应商、零售商以及制造商提供的产品数据明文传输，易被不法分子盗用。不法分子可利用这些有效信息，以正规厂商的名义生产，欺骗消费者。

&nbsp;&nbsp;&nbsp;&nbsp;近年，基于互联网的食品溯源体系也层出不穷，但大多数溯源体系是基于数据库实现。在该体系中，数据被集中存储在数据库中，但是食品生产者完全有能力在消费者不知情的情况下修改产品数据。这种"既当裁判员又当运动员"行为的直接受害者便是消费者。  
&nbsp;&nbsp;&nbsp;&nbsp;而基于区块链技术的食品溯源体系优势是对于任意一条数据的增删改都会在链上留下记录。此外，区块链的去中心化、开放性和自治性等优点可以给消费者提供信息查询渠道，知晓生产过程每一个环节的数据。把食品产销过程的关键数据和逻辑存储在区块链上，保证食品流通过程的信息成为无法更改的永久性记录。用区块链技术设计食品溯源系统可以解决传统追溯跟踪体系中供应链信息断裂、生产者消费者信息不对称以及数据安全的问题，全面增强食品溯源信息的安全性和可信性。  
&nbsp;&nbsp;&nbsp;&nbsp;2016年沃尔玛和IBM曾开发基于区块链的溯源系统。但是该溯源体系的缺点是并不适合中国的国情以及并未开源代码。该系统从源头到销售需要RFID来进行信息的追溯。虽然利用RFID能够轻松获得相对客观的数据，但是由于RFID本身的特性，其所能存储的信息有限。最重要的是，食品数量巨大，而每个RFID感应器的成本导致其部署粒度无法覆盖全部产品。因此这种高成本的溯源体系只能用于大型企业构成的合作体系，小型零售企业无法参与其中。
而本文档基于区块链技术构建了一个新型食品溯源系统，该系统解决了传统食品溯源体系的缺陷。该系统具有以下功能：

1. 市监局管理准入。市监局查验与食品溯源相关的企业的相关资质证书，证书有效者才有权限操作该系统的相应操作。针对有过违法犯罪行为的企业和个人，管理员可不分发权限，使得其只能查询信息，而无法操作。
检疫局抽检。产品出产后供应前需要有检疫局提供的抽检信息。
3. 制造商和供应商可通过溯源系统查看供应链信息并上传信息完成相应信息录入操作。
4. 消费者通过扫描二维码查看产品来源以及审查相关企业的资质证书等。
5. 消费者购买产品后，可进行信息销毁操作并获取积分，通过积分兑换奖品。该操作是防止链上信息爆炸的有效措施之一。

# &nbsp;&nbsp;&nbsp;&nbsp;**应用场景/解决的问题**
&nbsp;&nbsp;&nbsp;&nbsp;**对于生产过程造假和产品包装偷换的问题的解决方法：**市监局对各个有权限操作的实体进行资格核实。对于其提交到系统的信息进行审核，审核成功后市监局赋予其操作权限。对于审核不合格的企业，市监局无须赋予其操作权限。而检疫局在产品出产后供应前对产品进行抽检，并将抽检记录和结果上链。  
**&nbsp;&nbsp;&nbsp;&nbsp;对于供应链信息断裂问题的解决方法：**拥有操作权限的实体可随时查看链上数据。  
**&nbsp;&nbsp;&nbsp;&nbsp;对于数据容易泄露的问题的解决办法：**产品数据以哈希值存储，这些数据链上可查，且每个产品数据只能使用一次，防止造假。  
**&nbsp;&nbsp;&nbsp;&nbsp;对于区块链写入速度慢的解决办法：**联盟链指定记账节点，记账速度快。  
**&nbsp;&nbsp;&nbsp;&nbsp;对于追溯产品的颗粒度问题的解决方法：**采用第四象限法则来解决颗粒度问题。按照纵坐标是产品价值横坐标是购买频率将所有产品分成四种规格。包括：高购买频率高价值的产品、低购买频率低价值的产品、低购买频率高价值的产品以及高购买频率低价值的产品。对于高购买频率高价值的产品比如红酒等尽量溯源到最小颗粒度。对于高价值低购买频率的产品同样尽量溯源到相对小的颗粒度；而对于低价值高购买频率的产品可按照小箱产品来溯源；最后，低购买频率低价值的产品可以按照大箱来溯源。  
**&nbsp;&nbsp;&nbsp;&nbsp;对于食品溯源系统数据量巨大的问题的解决方法：**由消费者删除产品信息，只保留交易结果哈希值。  
**&nbsp;&nbsp;&nbsp;&nbsp;各个机构和企业具体提供的信息如下：**  
**&nbsp;&nbsp;&nbsp;&nbsp;市监局审查信息：**  
&nbsp;&nbsp;&nbsp;&nbsp;单位地址，负责人信息  
**&nbsp;&nbsp;&nbsp;&nbsp;检疫局：**  
&nbsp;&nbsp;&nbsp;&nbsp;负责人信息、抽检信息  
**&nbsp;&nbsp;&nbsp;&nbsp;供应商提供信息：**  
&nbsp;&nbsp;&nbsp;&nbsp;1.上链信息：供应商ID，送往的零售商ID，食品编号，出厂时间，交易数量  
&nbsp;&nbsp;&nbsp;&nbsp;2.链下信息：供货商名称，原产地，供应商注册证书  
**&nbsp;&nbsp;&nbsp;&nbsp;物流提供信息：**  
&nbsp;&nbsp;&nbsp;&nbsp;1.上链信息：物流ID，送往的分销商ID，运送人信息，车牌，运送时间  
&nbsp;&nbsp;&nbsp;&nbsp;2.链下信息：物流名称，食材状态，运输冷链温度，司机驾驶  
**&nbsp;&nbsp;&nbsp;&nbsp;制造商提供信息：**  
&nbsp;&nbsp;&nbsp;&nbsp;1.上链信息：制造商ID，送往的供应商ID，出厂时间，食品编号，保质期  
&nbsp;&nbsp;&nbsp;&nbsp;2.链下信息：制造商名称，配料，营业执照  
**&nbsp;&nbsp;&nbsp;&nbsp;零售商提供信息：**  
&nbsp;&nbsp;&nbsp;&nbsp;1.上链信息：零售商名称，上架时间  
&nbsp;&nbsp;&nbsp;&nbsp;2.链下信息：零售商ID 